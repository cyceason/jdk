## 深入剖析volatile
- volatile关键字的两层语义
    1. 一个线程修改了某个变量的值，这新值对其他线程来说是立即可见的
    2. 禁止进行指令重排序
        1. 当程序执行到volatile变量的读操作或者写操作时，在其前面的操作的更改肯定全部已经进行，且结果已经对后面的操作可见；
        2. 在进行指令优化时，不能将在对volatile变量访问的语句放在其后面执行，也不能把volatile变量后面的语句放到其前面执行
- volatile不保证原子性
- 原子性保证
    1. 采用synchronized
    2. 采用Lock
    3. 采用AtomicInteger

- volatile的原理和实现机制，加入volatile关键字时，会多出一个lock前缀指令”
    1. 它确保指令重排序时不会把其后面的指令排到内存屏障之前的位置，也不会把前面的指令排到内存屏障的后面
    2. 它会强制将对缓存的修改操作立即写入主存
    3. 如果是写操作，它会导致其他CPU中对应的缓存行无效